import{r as u,j as e}from"./react-vendor-DLdk58NU.js";import{B as b,D as T}from"./chat-DWKbrCFW.js";import{S as C,D,E as R,L as z,Q as E}from"./feedback-CSAG4b4V.js";import{aH as F,aI as L,w as M,R as q,ai as $,x as H,as as Q,aJ as k}from"./lucide-icons-BgbkIPPx.js";import"./vendor-DW66a48r.js";const B=s=>{var n;const[x,m]=u.useState("summary"),c=!!(s.facilitation&&s.facilitation.understandingScore>0),a=!!(s.storyAnalysis&&s.storyAnalysis.decisionScore>0),l=!!s.demoAnalysis,p=!l||s.detailedReview&&s.detailedReview.length>0,h=!!(s.logicAnalysis&&s.logicAnalysis.length>0)||!c&&!a&&!l,t=!!((n=s.questioningAnalysis)!=null&&n.stats)||!c&&!a&&!l,r=!l&&!!(s.exemplars&&s.exemplars.length>0);return{activeTab:x,setActiveTab:m,isFacilitationMode:c,isStoryMode:a,isDemoMode:l,showReviewTab:p,showLogicTab:h,showQuestioningTab:t,showExemplarsTab:r}},K=({feedback:s,messages:x,onReset:m,tokenUsage:c,isArchiveView:a,onBackToHistory:l,onAddHomework:p,onNavigate:h})=>{const{activeTab:t,setActiveTab:r,isDemoMode:n,showReviewTab:w,showLogicTab:j,showQuestioningTab:v,showExemplarsTab:y}=B(s),[N,f]=u.useState(new Set),S=(o,i)=>{var g;const d={id:Date.now().toString()+o,createdAt:new Date().toISOString(),title:i.title,description:i.description,targetSkills:i.targetSkills,difficulty:i.difficulty,status:"pending",mode:((g=i.suggestedPracticeModes)==null?void 0:g[0])||T.DEBATE};p([d]),f(A=>new Set(A).add(o))};return e.jsxs("div",{className:"h-full flex flex-col bg-slate-50",children:[e.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-4 flex items-center justify-between shrink-0 z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-800 font-bold text-lg",children:[e.jsx(F,{className:"text-yellow-500"}),e.jsx("span",{children:"Debate Result"})]}),e.jsx("div",{className:"flex gap-2",children:a?e.jsxs(b,{onClick:l,variant:"secondary",className:"flex items-center gap-2 text-sm bg-slate-100 text-slate-700",children:[e.jsx(L,{size:16})," 履歴に戻る"]}):e.jsxs(e.Fragment,{children:[e.jsxs(b,{onClick:m,variant:"secondary",className:"flex items-center gap-2 text-sm",children:[e.jsx(M,{size:16})," トップへ"]}),e.jsxs(b,{onClick:m,className:"flex items-center gap-2 text-sm shadow-md bg-gradient-to-r from-blue-600 to-blue-700 text-white",children:[e.jsx(q,{size:16})," 新しい議論を始める"]})]})})]}),e.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 flex items-center gap-6 overflow-x-auto scrollbar-hide shrink-0",children:[e.jsx("button",{onClick:()=>r("summary"),className:`py-3 text-sm font-bold border-b-2 transition-all whitespace-nowrap ${t==="summary"?"border-blue-600 text-blue-600":"border-transparent text-slate-500 hover:text-slate-800"}`,children:n?"模範分析":"総評 & スコア"}),w&&e.jsx("button",{onClick:()=>r("review"),className:`py-3 text-sm font-bold border-b-2 transition-all whitespace-nowrap ${t==="review"?"border-blue-600 text-blue-600":"border-transparent text-slate-500 hover:text-slate-800"}`,children:"会話ごとの詳細レビュー"}),y&&e.jsxs("button",{onClick:()=>r("exemplars"),className:`py-3 text-sm font-bold border-b-2 transition-all whitespace-nowrap flex items-center gap-1.5 ${t==="exemplars"?"border-blue-600 text-blue-600":"border-transparent text-slate-500 hover:text-slate-800"}`,children:[e.jsx($,{size:14})," アンカー事例・比較"]}),j&&e.jsx("button",{onClick:()=>r("logic"),className:`py-3 text-sm font-bold border-b-2 transition-all whitespace-nowrap ${t==="logic"?"border-blue-600 text-blue-600":"border-transparent text-slate-500 hover:text-slate-800"}`,children:"論理構造 (Toulmin Model)"}),v&&e.jsx("button",{onClick:()=>r("questioning"),className:`py-3 text-sm font-bold border-b-2 transition-all whitespace-nowrap ${t==="questioning"?"border-blue-600 text-blue-600":"border-transparent text-slate-500 hover:text-slate-800"}`,children:"質問力分析"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[t==="summary"&&e.jsxs("div",{className:"space-y-8",children:[e.jsx(C,{feedback:s,tokenUsage:c,isArchiveView:a,onNavigate:h}),!a&&!n&&s.homeworkSuggestions&&s.homeworkSuggestions.length>0&&e.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 rounded-2xl p-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 text-indigo-800",children:[e.jsx(H,{size:24}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold",children:"AIからの宿題 (Next Steps)"}),e.jsx("p",{className:"text-xs text-indigo-600",children:"今回の弱点を克服するためのタスクを提案します。"})]})]}),e.jsx("div",{className:"grid gap-4",children:s.homeworkSuggestions.map((o,i)=>{const d=N.has(i);return e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-indigo-100 shadow-sm flex flex-col sm:flex-row justify-between gap-4 items-start sm:items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"bg-indigo-100 text-indigo-700 text-[10px] font-bold px-2 py-0.5 rounded uppercase",children:o.difficulty}),e.jsx("h4",{className:"font-bold text-slate-800",children:o.title})]}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:o.description})]}),e.jsx("button",{onClick:()=>!d&&S(i,o),disabled:d,className:`shrink-0 px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2 transition-all ${d?"bg-emerald-100 text-emerald-700 cursor-default":"bg-indigo-600 text-white hover:bg-indigo-700 shadow-md active:scale-95"}`,children:d?e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:16})," 追加済み"]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{size:16})," 宿題リストに追加"]})})]},i)})})]})]}),t==="review"&&e.jsx(D,{feedback:s,messages:x,isDemoMode:n}),t==="exemplars"&&s.exemplars&&e.jsx(R,{exemplars:s.exemplars,messages:x,detailedReview:s.detailedReview||[]}),t==="logic"&&e.jsx(z,{logicAnalysis:s.logicAnalysis,messages:x}),t==="questioning"&&e.jsx(E,{questioningAnalysis:s.questioningAnalysis})]})})]})};export{K as FeedbackScreen};
