import{j as e,r as p}from"./react-vendor-DLdk58NU.js";import{B as m}from"./chat-DWKbrCFW.js";import{a0 as u,M as j,aH as g,z as N,A as y,w,aS as v,aT as z,aU as k,az as C}from"./lucide-icons-BgbkIPPx.js";import"./vendor-DW66a48r.js";const D=({archive:s,onSelect:a,onDelete:r,style:l})=>{const n=t=>{try{const d=new Date(t);return new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(d)}catch{return t}},o=t=>t>=80?"text-emerald-600 bg-emerald-50 border-emerald-200":t>=60?"text-blue-600 bg-blue-50 border-blue-200":"text-amber-600 bg-amber-50 border-amber-200";return e.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-slate-200 hover:shadow-md transition-all group animate-fade-in-up",style:l,children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-start md:items-center mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mb-1",children:[e.jsx(u,{size:12}),e.jsx("span",{children:n(s.date)}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-slate-300"}),e.jsx(j,{size:12}),e.jsxs("span",{children:[s.messages.length," turns"]})]}),e.jsx("h3",{className:"text-lg font-bold text-slate-800 truncate pr-4",children:s.topic})]}),e.jsxs("div",{className:`px-3 py-1.5 rounded-lg border font-bold text-lg flex items-center gap-1.5 shrink-0 ${o(s.feedback.score)}`,children:[e.jsx(g,{size:16}),s.feedback.score]})]}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded-xl text-sm text-slate-600 mb-4 line-clamp-2 border border-slate-100",children:[e.jsx("span",{className:"font-bold text-slate-400 text-xs uppercase mr-2",children:"Summary"}),s.feedback.summary]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-slate-100 pt-4 mt-2",children:[e.jsxs("button",{onClick:t=>{t.stopPropagation(),r(s.id)},className:"flex items-center gap-1.5 text-xs font-bold text-slate-400 hover:text-red-600 px-3 py-2 rounded-lg hover:bg-red-50 transition-colors",children:[e.jsx(N,{size:14}),"削除"]}),e.jsxs(m,{onClick:()=>a(s),size:"sm",className:"bg-slate-800 hover:bg-slate-900 text-white",children:["詳細を見る ",e.jsx(y,{size:16,className:"ml-1"})]})]})]})},H=s=>{const a=p.useMemo(()=>[...s].sort((l,n)=>new Date(n.date).getTime()-new Date(l.date).getTime()),[s]),r=a.length===0;return{sortedArchives:a,isEmpty:r}},R=({archives:s,onSelect:a,onDelete:r,onBack:l,onExport:n,onImport:o})=>e.jsx(S,{archives:s,onSelect:a,onDelete:r,onBack:l,onExport:n,onImport:o}),S=({archives:s,onSelect:a,onDelete:r,onBack:l,onExport:n,onImport:o})=>{const{sortedArchives:t,isEmpty:d}=H(s),c=p.useRef(null),b=()=>{var i;(i=c.current)==null||i.click()},f=async i=>{var h;const x=(h=i.target.files)==null?void 0:h[0];x&&(await o(x),c.current&&(c.current.value=""))};return e.jsxs("div",{className:"h-full bg-slate-50 flex flex-col animate-fade-in",children:[e.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-4 flex items-center justify-between shrink-0 z-10 sticky top-0 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{onClick:l,variant:"ghost",className:"p-2 -ml-2 text-slate-500 hover:bg-slate-100 rounded-full",children:e.jsx(w,{size:20})}),e.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(u,{size:20,className:"text-blue-600"}),e.jsx("span",{children:"議論の履歴"}),e.jsx("span",{className:"text-xs font-normal text-slate-500 bg-slate-100 px-2 py-0.5 rounded-full border border-slate-200",children:s.length})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",ref:c,onChange:f,className:"hidden",accept:".json"}),e.jsxs("button",{onClick:b,className:"flex items-center gap-1.5 px-3 py-2 text-xs font-bold text-slate-600 bg-white border border-slate-200 rounded-lg hover:text-blue-600 hover:border-blue-300 hover:bg-blue-50 transition-all shadow-sm",title:"バックアップファイルを読み込む",children:[e.jsx(v,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"インポート"})]}),e.jsxs("button",{onClick:n,className:"flex items-center gap-1.5 px-3 py-2 text-xs font-bold text-white bg-slate-700 border border-slate-700 rounded-lg hover:bg-slate-800 hover:border-slate-800 transition-all shadow-sm",title:"現在のデータをファイルに保存",children:[e.jsx(z,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"バックアップ保存"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-8",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:d?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-400",children:[e.jsx("div",{className:"bg-slate-100 p-6 rounded-full mb-4",children:e.jsx(k,{size:48,className:"opacity-50"})}),e.jsx("h3",{className:"text-lg font-bold text-slate-600 mb-2",children:"履歴がありません"}),e.jsx("p",{className:"text-sm mb-6",children:"議論を完了すると、ここに結果が保存されます。"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(m,{onClick:l,variant:"primary",children:"トップに戻る"}),e.jsxs(m,{onClick:b,variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(C,{size:16})," 過去のデータを復元"]})]})]}):e.jsx("div",{className:"space-y-4 pb-20",children:t.map((i,x)=>e.jsx(D,{archive:i,onSelect:a,onDelete:r,style:{animationDelay:`${x*50}ms`}},i.id))})})})]})};export{R as HistoryScreen};
